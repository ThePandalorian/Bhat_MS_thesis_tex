\epigraph{\justifying The theory of evolution by natural selection is an ecological theory—founded on ecological observation by perhaps the greatest of all ecologists. It has been adopted by and brought up by the science of genetics, and ecologists, being modest people, are apt to forget their distinguished parenthood}{John Harper~\citep{harper_darwinian_1967}}

%More than 150 years have passed since Charles Darwin first published \textit{Origin} (in 1859) and Ernst Haeckel first coined the term ‘ecology’ (in 1866). Today, both ecology and evolution are incredibly interdisciplinary fields, borrowing techniques and ideas from diverse areas such as computer science, statistics, economics, dynamical systems, physics, and information theory. With this development has come a cornucopia of models that try to understand biological phenomena in the language of these borrowed tools and techniques. Though many of these ideas are used to accurately describe and analyze specific systems, there is also value to formulating general models in abstract terms that only incorporate a small number of `fundamental' processes and try to capture the `essence' of a biological pattern~\citep{frank_natural_2012, vellend_theory_2016,luque_mirror_2021}. Such general organizing models are vital to theory-building~\citep{luque_mirror_2021} because they help clarify conceptual similarities and unifying factors between apparently disparate modelling frameworks, helping us seamlessly translate essential ideas from one theoretical language to another.
%
%\section{Idealization and generality}\label{idealization}
Idealization and generalization are part and parcel of science, and this is clear if one looks at the actual practice, be it theorists making unrealistic assumptions on paper to model specific phenomena or experimentalists creating artificially controlled conditions in the laboratory to test specific hypotheses~\citep{zuk_models_2018}. Indeed, some philosophers of science argued that ``the epistemic goal of science is not truth, but understanding''~\citep{potochnik_idealization_2018}, an idea generally echoed by practicing scientists~\citep{levins_strategy_1966,servedio_not_2014,zuk_models_2018,grainger_empiricists_2022}. In other words, since the world is complicated and humans are limited, general understanding inevitably comes at the cost of other desirable qualities such as the ability to make precise quantitative predictions. This is especially true for complex phenomena such as those that are the domain of ecology and evolution, where we are often not even aware of all the factors that are at play or how they interact. We thus benefit from formulating simple `general' models that provide simple qualitative predictions and help us think about the phenomena we study in a cohesive, unified framework that we can understand well~\citep{potochnik_idealization_2018,luque_mirror_2021}.   
 
A general approach need not (and often will not) be perfect or all-encompassing. As Robert MacArthur once remarked, ``general events are only seen by ecologists with rather blurred vision. The very sharp-sighted always find discrepancies and are able to see that there is no generality, only a spectrum of special cases”~\citep{kingsland_modeling_1985}. MacArthur was speaking primarily about biological generalities and special cases, but in a related vein, if our language of choice for expressing our general events is mathematics, making any non-trivial observations in complex fields such as ecology and evolution often requires \emph{mathematical} approximations and idealizations that may exclude or underplay several `low-level' model-specific details in favor of a more general description at a `higher' level achieved in some limit that only contains a small number of `model-independent' quantities, often derived from first principles. Formulating and studying such general frameworks can be greatly beneficial as an aid to thinking, sometimes precisely \emph{because} `blurry eyed' thinking that begins from a small set of fundamental first principles and only looks for general broad-brush regularities can be much more insightful than accounting for every little detail or special case. The success of such an approach is perhaps best illustrated by the success of statistical mechanics in physics - Statistical mechanics was essentially born from the idea that various useful statements about systems with many moving parts can be made without the need for knowing the excruciating details of every single moving part, and indeed, starting from first principles, this sort of explicitly `blurry-eyed' thinking that only looked at approximate properties was shown to be able to recover the phenomenological laws of thermodynamics as \emph{statistical} laws.

%In population ecology, Vellend has argued that conceptual synthesis requires
%``shifting the emphasis away from an organizational structure based on the useful lines of
%inquiry carved out by researchers, to one based on the fundamental processes that underlie community dynamics and patterns''~\citep{vellend_theory_2016}. Vellend's assertion is based on the
%fact that population genetics has managed to come up  with reasonably comprehensive theory due to its focus on the abstract `high-level’ processes of selection, mutation, drift, and
%gene flow (see section \ref{sec_history} below) instead of the myriad `low-level' processes that may be responsible for generating them. In contrast, he believes that practitioners of community ecology often focus on specific `low-level' processes such as predation rate, limiting resources (R\textsuperscript{*}), storage effects,
%priority effects, senescence, and niche partitioning, leading to a plethora of models (see Table
%5.1 in~\cite{vellend_theory_2016} for an in-exhaustive list of 24 such models) and the conclusion that
%community ecology `is a mess'. Vellend instead proposes speaking about ecological theory in terms of the `high-level’ processes of selection, ecological drift (demographic stochasticity), speciation,
%and dispersal, in direct analogy with the `high-level' processes of selection, genetic drift, mutation, and gene flow respectively in population genetics. Without dwelling on the practicality of such an organization, which has been written about in great detail in~\cite{vellend_theory_2016}, I will simply note that such an organization and broad analogy at the very least seems somewhat plausible from a theoretical viewpoint, and is desirable for providing a cohesive theoretical underpinning for speaking about various hypotheses and ideas in community ecology and how they relate to each other. This is especially relevant given the increasing recognition that population ecology and evolutionary dynamics (Here I really mean the theoretical frameworks of population genetics + quantitative genetics\footnote{Though one could perhaps argue that all evolutionary phenomena should be captured in this sort of framework for some sufficiently general definition of the words `population', `quantitative', and `genetics'. In Michael Lynch's words, ``Nothing in evolution makes sense except in the light of population genetics''~\citep{lynch_origins_2007}. I don't know if this is an extreme view, though, which is why these sentences are in a footnote :)}) are perhaps not as neatly separated as many early architects of the fields had thought~\citep{coulson_putting_2006,metcalf_why_2007,schoener_newest_2011,kokko_can_2017,lion_theoretical_2018,govaert_eco-evolutionary_2019,svensson_eco-evolutionary_2019,hendry_critique_2019}.

\section{A (very, very) brief summary of high-level modelling frameworks in population biology}\label{sec_history}

In biology, arguably the greatest such general organizing framework was the idea of evolution by natural selection as synthesized from myriad detailed observations by Charles Darwin. Theoretical population genetics has also had a long-standing tradition in building general organizing frameworks that `abstract away' some biological specificities in favor of a small number of `fundamental' notions like selection and mutation which act on a small number of `fundamental' quantities like fitness. The description of evolution in these general terms was first laid out in formal mathematical terms during the Modern Synthesis by authors such as Wright, Fisher, and Haldane, an extremely successful venture that unified two major schools of thought --- Mendelian genetics and Darwinian evolution --- that were, at the time, considered to be incompatible~\citep{provine_origins_2001}. It is currently thought that this unification would have been unlikely or would have taken much longer if the architects of the Modern Synthesis had stuck to verbal arguments instead of working with formal models in explicitly mathematical terms~\citep{walsh_darwins_2014}. 

The most general mathematical framework we have for evolutionary population biology is the Price equation. Indeed, much like statistical mechanics in physics, the Price equation is derived from a small number of very general first principles and is able to recover several standard equations as special cases. The Price equation partitions changes in population composition into multiple terms, each of which lends itself to a straightforward interpretation in terms of `high-level' evolutionary forces such as selection and mutation, thus providing a useful conceptual framework for thinking about how populations change over time~\citep{frank_natural_2012}. However, the greater complexity of ecology and evolution relative to physics has meant that the generality of the Price equation comes with a much bigger cost in predictive power - the Price equation in its most general formulation is dynamically insufficient\footnote{Since this is not very standard nomenclature outside theoretical biology and related fields: `Dynamically insufficient' means that the equation cannot be iterated, or presented in the form of a difference equation $x_{t+1} = F(x_t)$ or a differential equation $\dot{x} = F(x)$. Thus, we cannot predict a dynamic `trajectory' given an initial condition $x_0$. The term `insufficient' is to indicate that the equation requires `complete' information to be true and only relates two quantities `in retrospect'. It is thus `insufficient' for prediction. In our case, in its most general setting, the Price equation is usually formulated in a way that partitions a \emph{given} amount of phenotypic change between two populations (usually but not necessarily the same population at two different times) into change due to selection, transmission bias, etc., rather than \emph{predicting} a trajectory for how much phenotypic change will occur at various future times based on the \emph{current} phenotypic distribution.}~\citep{van_veelen_use_2005,frank_natural_2012,luque_one_2017}. However, this need not be the case, and indeed, several authors have put forth more predictive versions of the Price equation by moving to a continuous time differential equation framework in which the Price equation is dynamically sufficient but manifests in a slightly less general form~\citep{page_unifying_2002,lion_theoretical_2018}.

These general formulations are still often very difficult to coax concrete quantitative predictions from, but they do lend themselves to simple biological interpretation, and in the dynamically sufficient formulations, often provide \emph{qualitative} predictions. These qualitative predictions, as well as the decomposition of terms in the original Price equation, are useful primarily for their generality --- The Price equation gives us a clear idea of which evolutionary forces operate in which systems and when in an almost entirely `model-independent' language~\citep{okasha_evolution_2006,frank_natural_2012,queller_fundamental_2017,luque_one_2017}. It also leads to a small number of simple yet insightful `fundamental theorems' of population biology~\citep{queller_fundamental_2017, lion_theoretical_2018, lehtonen_price_2018} that serve a similar function, and unifies several various seemingly disjoint formal structures of evolution under a single theoretical banner~\citep{ lehtonen_price_2020, luque_mirror_2021}.

The success of the Modern Synthesis illustrates the value of formulating abstract mathematical models that only provide a `high-level' description of the fundamental processes required to capture the essence of biological evolution~\citep{provine_origins_2001,walsh_darwins_2014}. However, the evolutionary play that architects of the Modern Synthesis studied famously unfolds in the ecological theatre~\citep{hutchinson_ecological_1965}. Thus, quantities like fitness are not truly fundamental but instead emerge as the net result of various ecological interactions, tradeoffs, and constraints~\citep{metz_how_1992}, a fact that can have important consequences for evolution~\citep{coulson_putting_2006,schoener_newest_2011, kokko_can_2017}. Trying to understand such `eco-evolutionary feedbacks' or `eco-evolutionary dynamics' has sprouted a rich body of literature under the broad heading of `evolutionary ecology' that has greatly enriched our understanding of biological populations~\citep{coulson_putting_2006,metcalf_why_2007,schoener_newest_2011,brown_why_2016,kokko_can_2017,lion_theoretical_2018,govaert_eco-evolutionary_2019,svensson_eco-evolutionary_2019,hendry_critique_2019}. Several major theoretical frameworks in the slightly more general setting of eco-evolutionary dynamics --- such as evolutionary game theory and adaptive dynamics --- as well as the standard equations of population genetics and quantitative genetics, can still be recovered (in a very general sense) as special cases of a slightly reformulated version of the Price equation~\citep{page_unifying_2002,lion_theoretical_2018}.

One of the general guiding principles of much of this mathematization has been the assumption that incorporating the reality of finite population sizes into models leads to no major qualitative differences in behavior, only `adding noise' or `blurring out' the predictions of simpler infinite population models~\citep{page_unifying_2002}. Consequently, several major theoretical frameworks in the field, such as adaptive dynamics, are explicitly formulated in deterministic terms at the infinite population size limit. However, this assumption is largely unjustified, and since populations in the real world are finite and stochastic, checking whether stochastic models differ from their deterministic analogs is vital to furthering our understanding of the fundamentals of population biology~\citep{hastings_transients_2004, coulson_skeletons_2004, shoemaker_integrating_2020}. Today, we increasingly recognize that incorporating the finite and stochastic nature of the real world routinely has much stronger consequences than simply `adding noise' to deterministic expectations~\citep{boettiger_noise_2018}, with important consequences for both ecological~\citep{schreiber_does_2022} and evolutionary~\citep{delong_stochasticity_2023} theory. In ecology and evolution, stochastic models need not exhibit phenomena predicted by their deterministic analogues~\citep{proulx_what_2005, johansson_will_2006, claessen_delayed_2007,  wakano_evolutionary_2013, debarre_evolutionary_2016, johnson_two-dimensional_2021}. In addition, they exhibit novel phenomena not predicted by the deterministic approximations~\citep{rogers_demographic_2012, rogers_spontaneous_2012, rogers_modes_2015, veller_drift-induced_2017, delong_stochasticity_2023}, for example, even completely `reversing' the predictions of deterministic models~\citep{houchmandzadeh_selection_2012,houchmandzadeh_fluctuation_2015,constable_demographic_2016,mcleod_social_2019}..

Studies of neutral or near-neutral dynamics in population and quantitative genetics usually do take stochasticity seriously, explicitly modeling finite populations that follow stochastic dynamics. Unfortunately, the classic or standard stochastic models in both population genetics~\citep{fisher_genetical_1930,wright_evolution_1931, moran_random_1958, kimura_diffusion_1964} and quantitative genetics~\citep{crow_introduction_1970, lande_natural_1976} typically assume a fixed total population size, thus restricting their validity in a world where population sizes routinely fluctuate. Those models which study evolution in populations with non-constant size usually impose deterministic and typically phenomenological rules for how the total population size must vary~\citep{kimura_probability_1974,ewens_probability_1967,otto_probability_1997, engen_fixation_2009, waxman_unified_2011}. These rules further usually do not depend on population composition. Such models are thus somewhat artificial since demography and population size are forced to be independent quantities even though this is obviously not the case in natural populations, where population size is a `bulk' property whose value emerges from an intricate interplay of the individual-level demographic processes of birth and death~\citep{metcalf_why_2007,doebeli_towards_2017}. Notably, as mentioned above, the most general framework we have, the Price equation, is usually formulated as a deterministic, dynamically insufficient equation (but see~\cite{page_unifying_2002} and~\cite{lion_theoretical_2018} for a dynamically sufficient formulation that is deterministic and~\cite{rice_stochastic_2008} for a stochastic formulation that is dynamically insufficient). Since real-life populations are stochastic, finite, and of non-constant population size, this is somewhat of a problem, since we know that such deterministic approximations that may not capture important dynamics of the real systems of interest.

Incorporating stochasticity into deterministic systems is a tricky business, and, if done in a phenomenological manner by adding noise to a `deterministic skeleton'~\citep{coulson_skeletons_2004} in an ad-hoc fashion, can lead to models that are not self-consistent~\citep{strang_how_2019}. Further, this procedure of adding noise in an ad-hoc manner provides no insight into the mechanistic factors actually responsible for the stochasticity in the first place. Stochastic individual-based models, in which (probabilistic) rules are specified at the level of the individual and population level dynamics are systematically derived from first principles, are self-consistent, much more natural, and can fundamentally differ from the predictions made by simply adding noise terms to a deterministic model~\citep{black_stochastic_2012,strang_how_2019}. Formulating the fundamental formal structures of evolutionary biology in terms of the mechanistic demographic processes of birth and death at the individual level is also greatly desirable for biological reasons~\citep{metcalf_why_2007,geritz_mathematical_2012} because `all paths to fitness lead through demography'~\citep{metcalf_all_2007}. In other words, since demographic processes such as birth and death rates explicitly account for the ecology of the system, they can more accurately reflect the complex interplay between ecological and evolutionary processes and provide a more fundamental mechanistic description of the relevant evolutionary forces and population dynamics~\citep{doebeli_towards_2017}. In this thesis, I present a formulation of population dynamics constructed from mechanistic first principles grounded in individual-level birth and death. The mathematical formalism itself is very general and applies equally to the `high level' forces of population genetics and the `high level' forces of community ecology as postulated by~\cite{vellend_theory_2016}, though I will mostly stick to the population genetics interpretation in my discussions.

\section{A very brief outline of the rest of this thesis}
This section provides a bullet-point chapter-wise outline for convenience. A more detailed outline of the thesis, with explanations of the technical content covered, originality, etc., is provided in the next section.

This thesis develops a mathematical formalism for describing finite fluctuating populations from first principles and is structured as follows. The rest of this thesis is divided into two parts. Part \ref{part_theory} provides the complete formalism in all its gory mathematical detail, but in a (hopefully) accessible pedagogical style. Part \ref{part_summary} then (re)presents some major results from part \ref{part_theory} and discusses their implications and connections with previous studies. Appendix \ref{App_examples} presents some concrete examples of models for clarity regarding the major ideas.

\begin{itemize}
		\item Chapter \ref{chap_math_background} provides the necessary mathematical background and provides a toy example studying the size of a population of identical individuals that illustrates the major ideas used. If I am required to shoehorn this thesis into a `intro-methods-results-discussion' format, then chapter \ref{chap_math_background} can be thought of as providing a mathematical `introduction' and illustration of the `methods' that will be used (in chapter \ref{chap_BD}) and generalized (in chapter \ref{chap_infD_processes}) in a biological context to get `results'.
		\item Chapter \ref{chap_BD} develops a formalism for describing the evolution of finite fluctuating populations of individuals that come in arbitrarily many `types' which vary in a \emph{discrete} character. This yields equations that generalize the classic Price equation and replicator-mutator equation to finite fluctuating populations.
		\item Chapter \ref{chap_infD_processes} extends the ideas developed in chapter \ref{chap_BD} to populations that vary in a single one-dimensional \emph{quantitative} character and derives a so-called `stochastic field theory' that describes evolution in such populations. This also results in some mathematical equations that may be of independent interest to physicists and applied mathematicians.
		\item Chapter \ref{chap_unification} provides a technical summary of the major results by deriving three important stochastic differential equations. These are equations for type frequencies, the population mean value of an arbitrary type-level quantity, and the population variance of an arbitrary type-level quantity, and respectively generalize the replicator-mutator equation, the Price equation, and \cite{lion_theoretical_2018}'s variance equation to finite, stochastically fluctuating populations. These equations predict a directional evolutionary force called `noise-induced selection' that is only seen in finite, fluctuating populations. Some implications for social evolution and community ecology are discussed. I also briefly discuss the field equation formalism I develop in chapter \ref{chap_infD_processes}.
		\item Chapter \ref{sec_disc} provides a quick summary of the major results and discusses biological implications, connections with previous studies, and opportunities for future work. This chapter has no equations (!). Thus, readers who do not want any mathematical equations can skip all other chapters and directly read chapter \ref{sec_disc} if they are interested only in the final results and takeaways. 
\end{itemize}
\section{A more expanded outline of the rest of this thesis}

Chapter \ref{chap_math_background} provides the basic mathematical background required and illustrates the major ideas that we will use. To facilitate readership by a broad audience, I only assume passing familiarity with calculus (derivatives, integrals, Taylor expansions) and probability. Familiarity with stochastic calculus is helpful for some sections but is not required, and I present a brief introduction to the relevant notions from both Markov theory and stochastic calculus in section \ref{sec_math_background}. In section \ref{sec_1D_processes}, I present a toy example of tracking population size of a population of identical individuals in section. I introduce a description of the system via a `master equation', and then conduct a `system-size expansion' to obtain a Fokker-Planck equation for the system, thus illustrating all the major tools required. For completeness, I also conduct a weak noise approximation to arrive at a so-called `linear' Fokker-Planck equation that can be solved exactly to arrive at a closed-form solution.

Chapter \ref{chap_BD} deals with the evolution of discrete traits. In this case, the system is finite-dimensional, since we can completely specify the state of the system by simply listing out the number of individuals of each type in a vector. I introduce a general multivariate process to describe the evolution of discretely varying traits, and use the system size expansion to arrive at a continuous description of change in trait frequencies as an SDE under mild assumptions on the functional forms of the birth and death rates. Unlike many classic stochastic formulations in evolutionary theory~\citep{fisher_genetical_1930,wright_evolution_1931,moran_random_1958,crow_introduction_1970, lande_natural_1976,kimura_probability_1974}, I do not assume a fixed (effective) population size and instead allow the total population size to be a natural emergent property from the demographic processes of birth and death. I show that the deterministic limit of this process is the well-known replicator-mutator equation (or equivalently, the dynamic version of the Price equation), thus establishing the microscopic basis of well-known equations from stochastic first principles. I also illustrate some general predictions that can be made using the weak noise approximation for the sake of completeness.

While the mathematics of chapter \ref{chap_BD} is standard and well-understood, it has, to the best of my knowledge, not been applied before in the generality and context we use here. Several specific models of specific systems do use these mathematical techniques, but these papers are often written assuming familiarity with notions in physics and/or mathematics and thus may not be very accessible to theoretical ecologists who do not have formal training in these subjects (but see~\cite{czuppon_understanding_2021} for a recent pedagogical review on the general approach applied to Wright-Fisher and Moran processes, where total population size is constant). As such, chapters \ref{chap_math_background} and \ref{chap_BD} together also serve as a tutorial and technical introduction to some theoretical ideas: For ecologists, the chapter introduces `system size expansions' and illustrates their use in a general setting, and can be seen as a tutorial on modelling finite populations analytically with minimal assumptions; For population geneticists, the chapter illustrates how system-size approximations (`diffusion approximations' in the population genetics literature) can be carried out without assuming a constant (effective) population size and how this generalization has important consequences for the evolutionary forces at play; For physicists and applied mathematicians, the chapter presents a study of the consequences of applying the system-size expansion to the kind of density-dependent birth-death processes that are widely applicable in ecology and evolution - Unlike many physical systems, though demographic processes like birth and death over ecological timescales are usually formulated in terms of population numbers or densities, predictions in evolution are typically in terms of frequencies of types, and this fact has subtle consequences that can be overlooked if one only works with densities, as is often done in physics studies of eco-evolutionary systems.

Chapter \ref{chap_infD_processes} introduces a function-valued process to model the evolution of quantitative traits such as body size, which can take on uncountably many values. This function-valued process can then also be analyzed via an analog of the system-size approximation to arrive at a `functional' Fokker-Planck equation in which derivatives are replaced by functional derivatives. I show that classic equations from quantitative genetics such as Kimura's infinite alleles model and Lande's gradient dynamics can be derived as the infinite population limit of this stochastic process. I also conduct a weak noise approximation to arrive at a linear functional Fokker-Planck equation that can be analyzed for specific systems as required. Unlike the systems studied in Chapter \ref{chap_BD}, formalizing the study of the kind of processes we study in Chapter \ref{chap_infD_processes} is an active area of mathematical research~\citep{carmona_stochastic_1999,da_prato_stochastic_2014,prevot_concise_2007,liu_stochastic_2015,bogachev_fokker-planck-kolmogorov_2015,balan_gentle_2018} and the mathematics itself is far from settled.

Chapter \ref{chap_infD_processes} generalizes the work of Tim Rogers and colleagues~\citep{rogers_demographic_2012,rogers_spontaneous_2012,rogers_modes_2015} to a wide class of eco-evolutionary systems, and to the best of my knowledge, has never been presented in full generality before. Mathematically, chapter \ref{chap_infD_processes} presents heuristic, accessible alternatives to the rigorous tools of martingale theory and measure-valued branching processes that are usually employed to describe the evolution of quantitative traits~\citep{champagnat_unifying_2006,etheridge_mathematical_2011, week_white_2021} by generalizing the idea of a system size expansion of density-dependent (finite-dimensional) birth-death processes to the infinite-dimensional case using the notion of functional differentiation. Biologically, Chapter \ref{chap_infD_processes} provides `stochastic field equations' that describe the dynamics of one-dimensional quantitative traits in finite populations and illustrates that these equations are consistent with well-known formalisms in quantitative genetics at the infinite population limit.

Part \ref{part_summary} summarizes the major results of the formalism developed in Part \ref{part_theory} and presents some simple equations that can be argued to be `fundamental equations' of population biology in the sense of~\cite{queller_fundamental_2017}, and together form a `unifying perspective' in the sense of~\cite{lion_theoretical_2018}. These equations reduce to well-known results such as the Price equation, the replicator-mutator equation from evolutionary game theory, and Fisher's fundamental theorem from population genetics in the infinite population limit. For finite populations, these same equations predict a new evolutionary force, `noise-induced selection', that has still not found its way into the standard formal canon of evolutionary biology and whose significance is only recently being recognized~\citep{constable_demographic_2016,mcleod_social_2019,mazzolini_universality_2022, kuosmanen_turnover_2022}. Implications of noise-induced selection are also discussed in part \ref{part_summary}. Readers who are okay with mathematical equations but do not want any intermediate derivations (or just trust my math) can skip to Chapter \ref{chap_unification} for the major equations that emerge as being important, though I strongly encourage working through the entire formalism properly if possible. Readers who are averse to or do not care for equations can safely skip to Chapter \ref{sec_disc} directly for the major takeaways of this thesis.

